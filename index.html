<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>線上試衣間</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Huninn&family=Zen+Antique&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="subject.css" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="manifest" href="manifest.json" />
  </head>
  <body>
    <header><h1>線上試衣間</h1></header>
    <div class="main-content">
      <section id="flctn">
        <div class="model-container">
          <img
            id="base-model"
            src="clothes/model.png"
            alt="模特兒模型"
            class="layer-img"
            style="z-index: 0"
          />
          <img
            id="top-layer"
            src=""
            alt="上衣"
            class="layer-img"
            style="z-index: 1; display: none"
          />
          <img
            id="bottom-layer"
            src=""
            alt="下身"
            class="layer-img"
            style="z-index: 1; display: none"
          />
        </div>
      </section>
      <aside>
        <h3>衣服類型</h3>
        <ul>
          <li class="has-submenu">
            上身
            <ul class="submenu">
              <li>
                <!-- 將所有 data-* 屬性移到 img 上 -->
                <img
                  src="clothes/tshirt_thumb.png"
                  alt="短袖 T-Shirt"
                  class="item-img"
                  data-type="top"
                  data-img="clothes/tshirt.png"
                />
                <!-- 您也可以在圖片下方增加文字說明 -->
                <span>短袖 T-Shirt</span>
              </li>
            </ul>
          </li>

          <li class="has-submenu">
            下身
            <ul class="submenu">
              <li>
                <!-- 將所有 data-* 屬性移到 img 上 -->
                <img
                  src="clothes/skirt_thumb.png"
                  alt="短裙 Skirt"
                  class="item-img"
                  data-type="bottom"
                  data-img="clothes/skirt.png"
                />
                <span>短裙 Skirt</span>
              </li>
            </ul>
          </li>
          <li class="has-submenu">
            外套
            <ul class="submenu">
              <li>休閒外套</li>
              <li>針織外套</li>
              <li>罩衫</li>
              <li>背心</li>
            </ul>
          </li>
          <li class="has-submenu">
            鞋子
            <ul class="submenu">
              <li>休閒鞋</li>
              <li>跟鞋</li>
              <li>涼鞋</li>
              <li>靴子</li>
            </ul>
          </li>
          <li class="has-submenu">
            配件
            <ul class="submenu">
              <li>帽子</li>
              <li>項鍊</li>
              <li>包包</li>
            </ul>
          </li>
        </ul>
      </aside>
    </div>
    <script>
      // --- PWA Service Worker 註冊碼 (保留) ---
      if ("serviceWorker" in navigator) {
        window.addEventListener("load", function () {
          navigator.serviceWorker.register("/sw.js").then(
            function (registration) {
              console.log(
                "ServiceWorker registration successful: ",
                registration.scope
              );
            },
            function (err) {
              console.log("ServiceWorker registration failed: ", err);
            }
          );
        });
      }
      // --- 選單展開/收合功能 (手風琴效果) ---
      const menuItems = document.querySelectorAll(".has-submenu");
      menuItems.forEach((item) => {
        item.addEventListener("click", function (event) {
          event.stopPropagation();
          menuItems.forEach((otherItem) => {
            if (otherItem !== this) {
              otherItem.classList.remove("active");
            }
          });
          this.classList.toggle("active");
        });
      });

      // --- 圖片切換功能 (綁定到縮圖圖片) ---

      // 1. 獲取對應的圖層元素
      const topLayer = document.getElementById("top-layer");
      const bottomLayer = document.getElementById("bottom-layer");

      // 2. 獲取所有可點擊的衣物縮圖圖片 (使用 .item-img class)
      const itemImages = document.querySelectorAll(".item-img");

      itemImages.forEach((imgElement) => {
        // 將事件綁定在 img 標籤本身
        imgElement.addEventListener("click", function (event) {
          event.stopPropagation();

          // 從點擊的 img 標籤讀取資料
          const imgUrl = this.getAttribute("data-img");
          const dataType = this.getAttribute("data-type");

          if (imgUrl && dataType) {
            if (dataType === "top") {
              // 更新上身圖層的圖片來源並顯示
              topLayer.src = imgUrl;
              topLayer.style.display = "block";
            } else if (dataType === "bottom") {
              // 更新下身圖層的圖片來源並顯示
              bottomLayer.src = imgUrl;
              bottomLayer.style.display = "block";
            }
            // 可以繼續增加其他 dataType (例如: 'coat', 'shoes')
          }
        });
      });
    </script>
  </body>
</html>
